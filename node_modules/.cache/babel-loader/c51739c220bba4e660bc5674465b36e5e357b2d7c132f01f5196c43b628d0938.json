{"ast":null,"code":"import axios from \"axios\";\nimport { createAsyncThunk } from \"@reduxjs/toolkit\";\naxios.defaults.baseURL = \"https://connections-api.herokuapp.com\";\nfunction errorMessage(error) {}\nconst token = {\n  set(token) {\n    axios.defaults.headers.common.Authorization = `Bearer ${token}`;\n  },\n  unset() {\n    axios.defaults.headers.common.Authorization = \"\";\n  }\n};\nconst register = createAsyncThunk(\"auth/register\", async credentials => {\n  try {\n    const {\n      data\n    } = await axios.post(\"/users/signup\", credentials);\n    token.set(data.token);\n    return data;\n  } catch (error) {\n    console.log(error.response.data.errors.password.kind);\n  }\n});\nconst login = createAsyncThunk(\"auth/login\", async credentials => {\n  try {\n    const {\n      data\n    } = await axios.post(\"users/login\", credentials);\n    token.set(data.token);\n    return data;\n  } catch (error) {\n    console.log(error);\n  }\n});\nconst logOut = createAsyncThunk(\"auth/logout\", async () => {\n  try {\n    await axios.post(\"/users/logout\");\n    token.unset();\n  } catch (error) {\n    console.log(error);\n  }\n});\nconst fetchCurrentUser = createAsyncThunk(\"contacts/fetchCurrentUser\", async (_, _ref) => {\n  let {\n    getState,\n    rejectWithValue\n  } = _ref;\n  const state = getState();\n  const persistToken = state.auth.token;\n  if (persistToken === null) {\n    return state;\n  }\n  token.set(persistToken);\n  try {\n    const {\n      data\n    } = await axios.get(\"/users/current\");\n    return data;\n  } catch (error) {\n    console.log(error);\n  }\n});\nconst operations = {\n  register,\n  login,\n  logOut,\n  fetchCurrentUser\n};\nexport default operations;","map":{"version":3,"names":["axios","createAsyncThunk","defaults","baseURL","errorMessage","error","token","set","headers","common","Authorization","unset","register","credentials","data","post","console","log","response","errors","password","kind","login","logOut","fetchCurrentUser","_","getState","rejectWithValue","state","persistToken","auth","get","operations"],"sources":["C:/Projects/Phonebook/src/components/redux/auth/auth-operations.js"],"sourcesContent":["import axios from \"axios\";\r\nimport { createAsyncThunk } from \"@reduxjs/toolkit\";\r\n\r\naxios.defaults.baseURL = \"https://connections-api.herokuapp.com\";\r\n\r\nfunction errorMessage(error) {}\r\n\r\nconst token = {\r\n  set(token) {\r\n    axios.defaults.headers.common.Authorization = `Bearer ${token}`;\r\n  },\r\n  unset() {\r\n    axios.defaults.headers.common.Authorization = \"\";\r\n  },\r\n};\r\n\r\nconst register = createAsyncThunk(\"auth/register\", async (credentials) => {\r\n  try {\r\n    const { data } = await axios.post(\"/users/signup\", credentials);\r\n    token.set(data.token);\r\n    return data;\r\n  } catch (error) {\r\n    console.log(error.response.data.errors.password.kind);\r\n  }\r\n});\r\n\r\nconst login = createAsyncThunk(\"auth/login\", async (credentials) => {\r\n  try {\r\n    const { data } = await axios.post(\"users/login\", credentials);\r\n    token.set(data.token);\r\n    return data;\r\n  } catch (error) {\r\n    console.log(error);\r\n  }\r\n});\r\n\r\nconst logOut = createAsyncThunk(\"auth/logout\", async () => {\r\n  try {\r\n    await axios.post(\"/users/logout\");\r\n    token.unset();\r\n  } catch (error) {\r\n    console.log(error);\r\n  }\r\n});\r\n\r\nconst fetchCurrentUser = createAsyncThunk(\r\n  \"contacts/fetchCurrentUser\",\r\n  async (_, { getState, rejectWithValue }) => {\r\n    const state = getState();\r\n    const persistToken = state.auth.token;\r\n    if (persistToken === null) {\r\n      return state;\r\n    }\r\n\r\n    token.set(persistToken);\r\n    try {\r\n      const { data } = await axios.get(\"/users/current\");\r\n      return data;\r\n    } catch (error) {\r\n      console.log(error);\r\n    }\r\n  }\r\n);\r\n\r\nconst operations = { register, login, logOut, fetchCurrentUser };\r\n\r\nexport default operations;\r\n"],"mappings":"AAAA,OAAOA,KAAK,MAAM,OAAO;AACzB,SAASC,gBAAgB,QAAQ,kBAAkB;AAEnDD,KAAK,CAACE,QAAQ,CAACC,OAAO,GAAG,uCAAuC;AAEhE,SAASC,YAAY,CAACC,KAAK,EAAE,CAAC;AAE9B,MAAMC,KAAK,GAAG;EACZC,GAAG,CAACD,KAAK,EAAE;IACTN,KAAK,CAACE,QAAQ,CAACM,OAAO,CAACC,MAAM,CAACC,aAAa,GAAI,UAASJ,KAAM,EAAC;EACjE,CAAC;EACDK,KAAK,GAAG;IACNX,KAAK,CAACE,QAAQ,CAACM,OAAO,CAACC,MAAM,CAACC,aAAa,GAAG,EAAE;EAClD;AACF,CAAC;AAED,MAAME,QAAQ,GAAGX,gBAAgB,CAAC,eAAe,EAAE,MAAOY,WAAW,IAAK;EACxE,IAAI;IACF,MAAM;MAAEC;IAAK,CAAC,GAAG,MAAMd,KAAK,CAACe,IAAI,CAAC,eAAe,EAAEF,WAAW,CAAC;IAC/DP,KAAK,CAACC,GAAG,CAACO,IAAI,CAACR,KAAK,CAAC;IACrB,OAAOQ,IAAI;EACb,CAAC,CAAC,OAAOT,KAAK,EAAE;IACdW,OAAO,CAACC,GAAG,CAACZ,KAAK,CAACa,QAAQ,CAACJ,IAAI,CAACK,MAAM,CAACC,QAAQ,CAACC,IAAI,CAAC;EACvD;AACF,CAAC,CAAC;AAEF,MAAMC,KAAK,GAAGrB,gBAAgB,CAAC,YAAY,EAAE,MAAOY,WAAW,IAAK;EAClE,IAAI;IACF,MAAM;MAAEC;IAAK,CAAC,GAAG,MAAMd,KAAK,CAACe,IAAI,CAAC,aAAa,EAAEF,WAAW,CAAC;IAC7DP,KAAK,CAACC,GAAG,CAACO,IAAI,CAACR,KAAK,CAAC;IACrB,OAAOQ,IAAI;EACb,CAAC,CAAC,OAAOT,KAAK,EAAE;IACdW,OAAO,CAACC,GAAG,CAACZ,KAAK,CAAC;EACpB;AACF,CAAC,CAAC;AAEF,MAAMkB,MAAM,GAAGtB,gBAAgB,CAAC,aAAa,EAAE,YAAY;EACzD,IAAI;IACF,MAAMD,KAAK,CAACe,IAAI,CAAC,eAAe,CAAC;IACjCT,KAAK,CAACK,KAAK,EAAE;EACf,CAAC,CAAC,OAAON,KAAK,EAAE;IACdW,OAAO,CAACC,GAAG,CAACZ,KAAK,CAAC;EACpB;AACF,CAAC,CAAC;AAEF,MAAMmB,gBAAgB,GAAGvB,gBAAgB,CACvC,2BAA2B,EAC3B,OAAOwB,CAAC,WAAoC;EAAA,IAAlC;IAAEC,QAAQ;IAAEC;EAAgB,CAAC;EACrC,MAAMC,KAAK,GAAGF,QAAQ,EAAE;EACxB,MAAMG,YAAY,GAAGD,KAAK,CAACE,IAAI,CAACxB,KAAK;EACrC,IAAIuB,YAAY,KAAK,IAAI,EAAE;IACzB,OAAOD,KAAK;EACd;EAEAtB,KAAK,CAACC,GAAG,CAACsB,YAAY,CAAC;EACvB,IAAI;IACF,MAAM;MAAEf;IAAK,CAAC,GAAG,MAAMd,KAAK,CAAC+B,GAAG,CAAC,gBAAgB,CAAC;IAClD,OAAOjB,IAAI;EACb,CAAC,CAAC,OAAOT,KAAK,EAAE;IACdW,OAAO,CAACC,GAAG,CAACZ,KAAK,CAAC;EACpB;AACF,CAAC,CACF;AAED,MAAM2B,UAAU,GAAG;EAAEpB,QAAQ;EAAEU,KAAK;EAAEC,MAAM;EAAEC;AAAiB,CAAC;AAEhE,eAAeQ,UAAU"},"metadata":{},"sourceType":"module","externalDependencies":[]}